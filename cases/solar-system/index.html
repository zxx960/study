<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤ªé˜³ç³»è¿è¡ŒåŠ¨ç”» - Solar System Animation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            overflow: hidden;
            background: #000;
            font-family: Arial, sans-serif;
        }
        canvas {
            display: block;
        }
        #info {
            position: absolute;
            top: 20px;
            left: 20px;
            color: white;
            font-size: 14px;
            background: rgba(0, 0, 0, 0.5);
            padding: 15px;
            border-radius: 5px;
            max-width: 300px;
        }
        #info h1 {
            font-size: 18px;
            margin-bottom: 10px;
        }
        #info p {
            margin: 5px 0;
            font-size: 12px;
        }
        #tooltip {
            position: absolute;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 14px;
            pointer-events: none;
            display: none;
            z-index: 1000;
            border: 1px solid #555;
        }
        #planet-card {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 20, 0.9);
            color: white;
            padding: 20px;
            border-radius: 10px;
            width: 320px;
            max-height: 80vh;
            overflow-y: auto;
            display: none;
            z-index: 1000;
            border: 2px solid #4a90e2;
            box-shadow: 0 4px 20px rgba(74, 144, 226, 0.3);
        }
        #planet-card.show {
            display: block;
            animation: slideIn 0.3s ease-out;
        }
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        #planet-card h2 {
            font-size: 24px;
            margin-bottom: 15px;
            color: #4a90e2;
            border-bottom: 2px solid #4a90e2;
            padding-bottom: 10px;
        }
        #planet-card .info-item {
            margin: 10px 0;
            line-height: 1.6;
        }
        #planet-card .info-label {
            font-weight: bold;
            color: #88b3e6;
        }
        #planet-card .close-btn {
            position: absolute;
            top: 10px;
            right: 15px;
            background: none;
            border: none;
            color: #fff;
            font-size: 24px;
            cursor: pointer;
            padding: 0;
            width: 30px;
            height: 30px;
            line-height: 30px;
            text-align: center;
            border-radius: 50%;
        }
        #planet-card .close-btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        #pause-btn {
            position: absolute;
            bottom: 30px;
            right: 30px;
            background: rgba(74, 144, 226, 0.9);
            color: white;
            border: 2px solid #4a90e2;
            padding: 15px 30px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            border-radius: 50px;
            box-shadow: 0 4px 15px rgba(74, 144, 226, 0.4);
            transition: all 0.3s ease;
            z-index: 1000;
        }
        #pause-btn:hover {
            background: rgba(74, 144, 226, 1);
            box-shadow: 0 6px 20px rgba(74, 144, 226, 0.6);
            transform: scale(1.05);
        }
        #pause-btn:active {
            transform: scale(0.95);
        }
    </style>
</head>
<body>
    <div id="info">
        <h1>ğŸŒŒ å¤ªé˜³ç³»è¿è¡ŒåŠ¨ç”»</h1>
        <p>ğŸ–±ï¸ é¼ æ ‡æ‹–åŠ¨æ—‹è½¬è§†è§’</p>
        <p>ğŸ” æ»šè½®ç¼©æ”¾è·ç¦»</p>
        <p>â­ åŒ…å«å¤ªé˜³å’Œå…«å¤§è¡Œæ˜Ÿ</p>
        <p>ğŸ’« é¼ æ ‡æ‚¬åœæŸ¥çœ‹æ˜Ÿçƒåç§°</p>
        <p>ğŸŒ ç‚¹å‡»æ˜ŸçƒæŸ¥çœ‹è¯¦ç»†ä¿¡æ¯</p>
    </div>
    <div id="tooltip"></div>
    <div id="planet-card">
        <button class="close-btn" onclick="closePlanetCard()">Ã—</button>
        <div id="planet-card-content"></div>
    </div>
    <button id="pause-btn" onclick="togglePause()">â¸ï¸ æš‚åœ</button>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
        // åœºæ™¯ã€ç›¸æœºã€æ¸²æŸ“å™¨
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 10000);
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        // æ·»åŠ æ˜Ÿç©ºèƒŒæ™¯
        const starGeometry = new THREE.BufferGeometry();
        const starVertices = [];
        for (let i = 0; i < 1000; i++) {
            const x = (Math.random() - 0.5) * 4000;
            const y = (Math.random() - 0.5) * 4000;
            const z = (Math.random() - 0.5) * 4000;
            starVertices.push(x, y, z);
        }
        starGeometry.setAttribute('position', new THREE.Float32BufferAttribute(starVertices, 3));
        const starMaterial = new THREE.PointsMaterial({ color: 0xffffff, size: 2 });
        const stars = new THREE.Points(starGeometry, starMaterial);
        scene.add(stars);

        // åˆ›å»ºå¤ªé˜³
        const sunGeometry = new THREE.SphereGeometry(30, 32, 32);
        const sunMaterial = new THREE.MeshBasicMaterial({ 
            color: 0xffff00,
            emissive: 0xffaa00
        });
        const sun = new THREE.Mesh(sunGeometry, sunMaterial);
        sun.userData = { name: 'å¤ªé˜³' };
        scene.add(sun);

        // æ·»åŠ å¤ªé˜³å…‰
        const sunLight = new THREE.PointLight(0xffffff, 2, 1000);
        sunLight.position.set(0, 0, 0);
        scene.add(sunLight);

        // ç¯å¢ƒå…‰
        const ambientLight = new THREE.AmbientLight(0x333333);
        scene.add(ambientLight);

        // æ˜Ÿçƒè¯¦ç»†ä¿¡æ¯æ•°æ®
        const celestialInfo = {
            'å¤ªé˜³': {
                name: 'å¤ªé˜³',
                type: 'æ’æ˜Ÿ',
                diameter: '1,392,700 å…¬é‡Œ',
                mass: 'åœ°çƒçš„ 333,000 å€',
                temperature: 'è¡¨é¢æ¸©åº¦çº¦ 5,500Â°C',
                composition: 'ä¸»è¦ç”±æ°¢å’Œæ°¦ç»„æˆ',
                description: 'å¤ªé˜³æ˜¯å¤ªé˜³ç³»çš„ä¸­å¿ƒå¤©ä½“ï¼Œå æœ‰å¤ªé˜³ç³»æ€»è´¨é‡çš„99.86%ã€‚å®ƒæ˜¯ä¸€é¢—é»„çŸ®æ˜Ÿï¼Œé€šè¿‡æ ¸èšå˜ååº”äº§ç”Ÿèƒ½é‡ã€‚',
                features: ['å…‰çƒå±‚æ¸©åº¦çº¦500ä¸‡åº¦', 'æ¯ç§’é’Ÿ20ä¸‡å¨æ°¢è½¬åŒ–ä¸ºæ°¦', 'å¯¿å‘½çº¦100äº¿å¹´']
            },
            'æ°´æ˜Ÿ': {
                name: 'æ°´æ˜Ÿ',
                type: 'ç±»åœ°è¡Œæ˜Ÿ',
                diameter: '4,879 å…¬é‡Œ',
                mass: 'åœ°çƒçš„ 0.055 å€',
                temperature: '-173Â°C è‡³ 427Â°C',
                orbitalPeriod: 'å…¬è½¬å‘¨æœŸ 88 å¤©',
                description: 'æ°´æ˜Ÿæ˜¯å¤ªé˜³ç³»æœ€å°çš„è¡Œæ˜Ÿï¼Œä¹Ÿæ˜¯ç¦»å¤ªé˜³æœ€è¿‘çš„è¡Œæ˜Ÿã€‚ç”±äºæ²¡æœ‰å¤§æ°”å±‚ï¼Œæ°´æ˜Ÿè¡¨é¢æ¸©åº¦å˜åŒ–å¾ˆå¤§ã€‚',
                features: ['è¡¨é¢å¸ƒæ»¡é™¨çŸ³å‘', 'æœ‰ä¸€ä¸ªé“æ ¸', 'å‡ ä¹æ²¡æœ‰å¤§æ°”å±‚']
            },
            'é‡‘æ˜Ÿ': {
                name: 'é‡‘æ˜Ÿ',
                type: 'ç±»åœ°è¡Œæ˜Ÿ',
                diameter: '12,104 å…¬é‡Œ',
                mass: 'åœ°çƒçš„ 0.815 å€',
                temperature: 'è¡¨é¢æ¸©åº¦çº¦ 462Â°C',
                orbitalPeriod: 'å…¬è½¬å‘¨æœŸ 225 å¤©',
                description: 'é‡‘æ˜Ÿæ˜¯ä»å¤ªé˜³å‘å¤–çš„ç¬¬äºŒé¢—è¡Œæ˜Ÿï¼Œæ˜¯å¤ªé˜³ç³»ä¸­æœ€çƒ­çš„è¡Œæ˜Ÿã€‚æµ“åšçš„å¤§æ°”å±‚äº§ç”Ÿå¼ºçƒˆçš„æ¸©å®¤æ•ˆåº”ã€‚',
                features: ['é€†å‘è‡ªè½¬', 'æµ“åšçš„äºŒæ°§åŒ–ç¢³å¤§æ°”', 'æœ€äº®çš„è¡Œæ˜Ÿ']
            },
            'åœ°çƒ': {
                name: 'åœ°çƒ',
                type: 'ç±»åœ°è¡Œæ˜Ÿ',
                diameter: '12,742 å…¬é‡Œ',
                mass: '5.972 Ã— 10Â²â´ åƒå…‹',
                temperature: 'å¹³å‡æ¸©åº¦ 15Â°C',
                orbitalPeriod: 'å…¬è½¬å‘¨æœŸ 365.25 å¤©',
                description: 'åœ°çƒæ˜¯å¤ªé˜³ç³»ä¸­å”¯ä¸€ç¡®è®¤å­˜åœ¨ç”Ÿå‘½çš„è¡Œæ˜Ÿã€‚æœ‰71%çš„è¡¨é¢è¢«æ°´è¦†ç›–ï¼Œå…·æœ‰é€‚å®œç”Ÿå‘½çš„å¤§æ°”å±‚ã€‚',
                features: ['å”¯ä¸€æœ‰ç”Ÿå‘½çš„æ˜Ÿçƒ', 'å«æ˜Ÿï¼šæœˆçƒ', 'æ¶²æ€æ°´å¤§é‡å­˜åœ¨']
            },
            'ç«æ˜Ÿ': {
                name: 'ç«æ˜Ÿ',
                type: 'ç±»åœ°è¡Œæ˜Ÿ',
                diameter: '6,779 å…¬é‡Œ',
                mass: 'åœ°çƒçš„ 0.107 å€',
                temperature: 'å¹³å‡æ¸©åº¦ -63Â°C',
                orbitalPeriod: 'å…¬è½¬å‘¨æœŸ 687 å¤©',
                description: 'ç«æ˜Ÿè¢«ç§°ä¸º"çº¢è‰²æ˜Ÿçƒ"ï¼Œæ˜¯ä¸‹ä¸€ä¸ªäººç±»æ¢ç´¢ç›®æ ‡ã€‚è¡¨é¢æœ‰å¤ªé˜³ç³»æœ€å¤§çš„å±±å³°å’Œå³¡è°·ã€‚',
                features: ['è¡¨é¢æ°§åŒ–é“å‘ˆçº¢è‰²', 'æœ‰ä¸¤é¢—å°å«æ˜Ÿ', 'æå† ç”±å†°ç»„æˆ']
            },
            'æœ¨æ˜Ÿ': {
                name: 'æœ¨æ˜Ÿ',
                type: 'æ°”æ€å·¨è¡Œæ˜Ÿ',
                diameter: '139,820 å…¬é‡Œ',
                mass: 'åœ°çƒçš„ 318 å€',
                temperature: 'äº‘é¡¶æ¸©åº¦ -145Â°C',
                orbitalPeriod: 'å…¬è½¬å‘¨æœŸ 11.86 å¹´',
                description: 'æœ¨æ˜Ÿæ˜¯å¤ªé˜³ç³»æœ€å¤§çš„è¡Œæ˜Ÿï¼Œä¸»è¦ç”±æ°¢å’Œæ°¦ç»„æˆã€‚å…·æœ‰å¼ºå¤§çš„ç£åœºå’Œ79é¢—å·²çŸ¥å«æ˜Ÿã€‚',
                features: ['å¤§çº¢æ–‘é£æš´', 'æœ‰å¾®å¼±çš„è¡Œæ˜Ÿç¯', '79é¢—å·²çŸ¥å«æ˜Ÿ']
            },
            'åœŸæ˜Ÿ': {
                name: 'åœŸæ˜Ÿ',
                type: 'æ°”æ€å·¨è¡Œæ˜Ÿ',
                diameter: '116,460 å…¬é‡Œ',
                mass: 'åœ°çƒçš„ 95 å€',
                temperature: 'äº‘é¡¶æ¸©åº¦ -178Â°C',
                orbitalPeriod: 'å…¬è½¬å‘¨æœŸ 29.46 å¹´',
                description: 'åœŸæ˜Ÿä»¥å…¶å£®è§‚çš„è¡Œæ˜Ÿç¯ç³»ç»Ÿè€Œé—»åï¼Œä¸»è¦ç”±å†°é¢—ç²’å’Œå°˜åŸƒç»„æˆã€‚å¯†åº¦æ¯”æ°´è¿˜å°ã€‚',
                features: ['å£®è§‚çš„è¡Œæ˜Ÿç¯', '82é¢—å·²çŸ¥å«æ˜Ÿ', 'å¯†åº¦æœ€å°çš„è¡Œæ˜Ÿ']
            },
            'å¤©ç‹æ˜Ÿ': {
                name: 'å¤©ç‹æ˜Ÿ',
                type: 'å†°å·¨è¡Œæ˜Ÿ',
                diameter: '50,724 å…¬é‡Œ',
                mass: 'åœ°çƒçš„ 14.5 å€',
                temperature: 'äº‘é¡¶æ¸©åº¦ -224Â°C',
                orbitalPeriod: 'å…¬è½¬å‘¨æœŸ 84 å¹´',
                description: 'å¤©ç‹æ˜Ÿæ˜¯ç¬¬ä¸€é¢—é€šè¿‡æœ›è¿œé•œå‘ç°çš„è¡Œæ˜Ÿã€‚å®ƒçš„è‡ªè½¬è½´å‡ ä¹ä¸å…¬è½¬è½¨é“å¹³é¢å¹³è¡Œã€‚',
                features: ['æ¨ªå‘è‡ªè½¬', 'æœ‰æ·¡è“è‰²å¤–è§‚', '27é¢—å·²çŸ¥å«æ˜Ÿ']
            },
            'æµ·ç‹æ˜Ÿ': {
                name: 'æµ·ç‹æ˜Ÿ',
                type: 'å†°å·¨è¡Œæ˜Ÿ',
                diameter: '49,244 å…¬é‡Œ',
                mass: 'åœ°çƒçš„ 17 å€',
                temperature: 'äº‘é¡¶æ¸©åº¦ -214Â°C',
                orbitalPeriod: 'å…¬è½¬å‘¨æœŸ 165 å¹´',
                description: 'æµ·ç‹æ˜Ÿæ˜¯å¤ªé˜³ç³»æœ€å¤–ä¾§çš„è¡Œæ˜Ÿï¼Œé€šè¿‡æ•°å­¦é¢„æµ‹è€Œå‘ç°ã€‚å…·æœ‰å¤ªé˜³ç³»æœ€å¼ºçš„é£æš´ã€‚',
                features: ['æ·±è“è‰²å¤–è§‚', 'æœ€å¼ºé£é€Ÿè¶…è¿‡2000km/h', '14é¢—å·²çŸ¥å«æ˜Ÿ']
            }
        };

        // è¡Œæ˜Ÿæ•°æ®: [åç§°, åŠå¾„, é¢œè‰², è½¨é“åŠé•¿è½´, ç¦»å¿ƒç‡, å…¬è½¬é€Ÿåº¦, è‡ªè½¬é€Ÿåº¦]
        // ç¦»å¿ƒç‡æ•°æ®æ¥è‡ªçœŸå®å¤ªé˜³ç³»
        const planetsData = [
            ['æ°´æ˜Ÿ', 3.5, 0x8c7853, 60, 0.206, 0.04, 0.01],
            ['é‡‘æ˜Ÿ', 8, 0xffc649, 85, 0.007, 0.015, 0.005],
            ['åœ°çƒ', 8.5, 0x4169e1, 110, 0.017, 0.01, 0.02],
            ['ç«æ˜Ÿ', 5, 0xcd5c5c, 140, 0.093, 0.008, 0.018],
            ['æœ¨æ˜Ÿ', 20, 0xdaa520, 200, 0.049, 0.002, 0.04],
            ['åœŸæ˜Ÿ', 17, 0xf4a460, 260, 0.057, 0.0009, 0.038],
            ['å¤©ç‹æ˜Ÿ', 12, 0x4fd0e0, 320, 0.046, 0.0004, 0.03],
            ['æµ·ç‹æ˜Ÿ', 11, 0x4169e1, 370, 0.010, 0.0001, 0.032]
        ];

        const planets = [];
        const orbits = [];

        // åˆ›å»ºå°è¡Œæ˜Ÿå¸¦ï¼ˆç«æ˜Ÿå’Œæœ¨æ˜Ÿä¹‹é—´ï¼‰
        const asteroidBelt = new THREE.Group();
        const asteroidCount = 800;
        const asteroidInnerRadius = 155;
        const asteroidOuterRadius = 185;
        
        for (let i = 0; i < asteroidCount; i++) {
            // éšæœºå¤§å°çš„å°è¡Œæ˜Ÿ
            const size = Math.random() * 1.5 + 0.3;
            const asteroidGeometry = new THREE.SphereGeometry(size, 6, 6);
            const asteroidMaterial = new THREE.MeshStandardMaterial({
                color: 0x888888,
                roughness: 0.9,
                metalness: 0.1
            });
            const asteroid = new THREE.Mesh(asteroidGeometry, asteroidMaterial);
            
            // éšæœºåˆ†å¸ƒåœ¨ç¯å½¢åŒºåŸŸ
            const radius = asteroidInnerRadius + Math.random() * (asteroidOuterRadius - asteroidInnerRadius);
            const angle = Math.random() * Math.PI * 2;
            const yOffset = (Math.random() - 0.5) * 10; // è½»å¾®çš„å‚ç›´åˆ†å¸ƒ
            
            asteroid.position.x = Math.cos(angle) * radius;
            asteroid.position.y = yOffset;
            asteroid.position.z = Math.sin(angle) * radius;
            
            // å­˜å‚¨è¿åŠ¨å‚æ•°
            asteroid.userData = {
                radius: radius,
                angle: angle,
                speed: 0.003 + Math.random() * 0.002, // éšæœºå…¬è½¬é€Ÿåº¦
                yOffset: yOffset
            };
            
            asteroidBelt.add(asteroid);
        }
        scene.add(asteroidBelt);

        // åˆ›å»ºè¡Œæ˜Ÿå’Œè½¨é“
        planetsData.forEach(([name, radius, color, semiMajorAxis, eccentricity, revolutionSpeed, rotationSpeed]) => {
            // æ¤­åœ†å‚æ•°ï¼ša = åŠé•¿è½´ï¼Œe = ç¦»å¿ƒç‡ï¼Œb = åŠçŸ­è½´
            const a = semiMajorAxis;
            const e = eccentricity;
            const b = a * Math.sqrt(1 - e * e);
            const c = a * e; // ç„¦ç‚¹åˆ°ä¸­å¿ƒçš„è·ç¦»
            
            // åˆ›å»ºæ¤­åœ†è½¨é“çº¿
            const orbitGeometry = new THREE.BufferGeometry();
            const orbitPoints = [];
            for (let i = 0; i <= 128; i++) {
                const angle = (i / 128) * Math.PI * 2;
                // æ¤­åœ†æ–¹ç¨‹ï¼Œå¤ªé˜³åœ¨ç„¦ç‚¹ä½ç½®ï¼Œæ‰€ä»¥è½¨é“ä¸­å¿ƒåç§» c
                orbitPoints.push(
                    Math.cos(angle) * a - c,
                    0,
                    Math.sin(angle) * b
                );
            }
            orbitGeometry.setAttribute('position', new THREE.Float32BufferAttribute(orbitPoints, 3));
            const orbitMaterial = new THREE.LineBasicMaterial({ color: 0x444444 });
            const orbit = new THREE.Line(orbitGeometry, orbitMaterial);
            scene.add(orbit);
            orbits.push(orbit);

            // åˆ›å»ºè¡Œæ˜Ÿ
            const planetGeometry = new THREE.SphereGeometry(radius, 32, 32);
            const planetMaterial = new THREE.MeshStandardMaterial({ 
                color: color,
                roughness: 0.7,
                metalness: 0.3
            });
            const planet = new THREE.Mesh(planetGeometry, planetMaterial);
            planet.userData = { name: name };
            
            // åˆå§‹è§’åº¦éšæœº
            const initialAngle = Math.random() * Math.PI * 2;
            
            // è®¾ç½®åˆå§‹ä½ç½®ï¼ˆé¿å…è¡Œæ˜Ÿåœ¨åŸç‚¹é—ªçƒï¼‰
            planet.position.x = Math.cos(initialAngle) * a - c;
            planet.position.z = Math.sin(initialAngle) * b;
            
            scene.add(planet);
            
            planets.push({
                mesh: planet,
                revolutionSpeed: revolutionSpeed,
                rotationSpeed: rotationSpeed,
                semiMajorAxis: a,
                semiMinorAxis: b,
                eccentricity: e,
                focalDistance: c,
                angle: initialAngle
            });

            // ä¸ºåœŸæ˜Ÿæ·»åŠ å…‰ç¯
            if (name === 'åœŸæ˜Ÿ') {
                const ringGeometry = new THREE.RingGeometry(radius * 1.5, radius * 2.5, 32);
                const ringMaterial = new THREE.MeshBasicMaterial({ 
                    color: 0xc9b181,
                    side: THREE.DoubleSide,
                    transparent: true,
                    opacity: 0.6
                });
                const ring = new THREE.Mesh(ringGeometry, ringMaterial);
                ring.rotation.x = Math.PI / 2;
                planet.add(ring);
            }
        });

        // ç›¸æœºä½ç½®
        camera.position.set(0, 600, 0);
        camera.lookAt(0, 0, 0);

        // é¼ æ ‡æ§åˆ¶å’Œå°„çº¿æ£€æµ‹
        let isDragging = false;
        let previousMousePosition = { x: 0, y: 0 };
        let cameraAngle = { theta: 0, phi: 0.1 };
        let cameraDistance = 600;
        let isPaused = false;
        
        // å°„çº¿æ£€æµ‹å™¨
        const raycaster = new THREE.Raycaster();
        const mouse = new THREE.Vector2();
        const tooltip = document.getElementById('tooltip');
        
        // æ”¶é›†æ‰€æœ‰å¯ä»¥æ£€æµ‹çš„æ˜Ÿçƒï¼ˆå¤ªé˜³ + è¡Œæ˜Ÿï¼‰
        const celestialBodies = [sun, ...planets.map(p => p.mesh)];

        renderer.domElement.addEventListener('mousedown', (e) => {
            isDragging = true;
            previousMousePosition = { x: e.clientX, y: e.clientY };
        });

        renderer.domElement.addEventListener('mousemove', (e) => {
            if (isDragging) {
                const deltaX = e.clientX - previousMousePosition.x;
                const deltaY = e.clientY - previousMousePosition.y;
                
                cameraAngle.theta += deltaX * 0.005;
                cameraAngle.phi += deltaY * 0.005;
                
                // é™åˆ¶å‚ç›´è§’åº¦
                cameraAngle.phi = Math.max(0.1, Math.min(Math.PI - 0.1, cameraAngle.phi));
                
                previousMousePosition = { x: e.clientX, y: e.clientY };
            }
            
            // å°„çº¿æ£€æµ‹æ‚¬åœ
            mouse.x = (e.clientX / window.innerWidth) * 2 - 1;
            mouse.y = -(e.clientY / window.innerHeight) * 2 + 1;
            
            raycaster.setFromCamera(mouse, camera);
            const intersects = raycaster.intersectObjects(celestialBodies);
            
            if (intersects.length > 0) {
                const object = intersects[0].object;
                if (object.userData.name) {
                    tooltip.style.display = 'block';
                    tooltip.style.left = e.clientX + 10 + 'px';
                    tooltip.style.top = e.clientY - 30 + 'px';
                    tooltip.textContent = object.userData.name;
                    document.body.style.cursor = 'pointer';
                }
            } else {
                tooltip.style.display = 'none';
                document.body.style.cursor = 'default';
            }
        });

        renderer.domElement.addEventListener('mouseup', () => {
            isDragging = false;
        });

        // ç‚¹å‡»äº‹ä»¶ç›‘å¬
        renderer.domElement.addEventListener('click', (e) => {
            // åªæœ‰åœ¨æœªæ‹–åŠ¨æ—¶æ‰å“åº”ç‚¹å‡»
            if (!isDragging) {
                mouse.x = (e.clientX / window.innerWidth) * 2 - 1;
                mouse.y = -(e.clientY / window.innerHeight) * 2 + 1;
                
                raycaster.setFromCamera(mouse, camera);
                const intersects = raycaster.intersectObjects(celestialBodies);
                
                if (intersects.length > 0) {
                    const object = intersects[0].object;
                    if (object.userData.name) {
                        showPlanetCard(object.userData.name);
                    }
                }
            }
        });

        renderer.domElement.addEventListener('wheel', (e) => {
            e.preventDefault();
            cameraDistance += e.deltaY * 0.2;
            cameraDistance = Math.max(100, Math.min(1000, cameraDistance));
        });

        // æ˜¾ç¤ºæ˜ŸçƒçŸ¥è¯†å¡ç‰‡
        function showPlanetCard(planetName) {
            const info = celestialInfo[planetName];
            if (!info) return;
            
            const card = document.getElementById('planet-card');
            const content = document.getElementById('planet-card-content');
            
            let html = `<h2>${info.name}</h2>`;
            html += `<div class="info-item"><span class="info-label">ç±»å‹ï¼š</span>${info.type}</div>`;
            html += `<div class="info-item"><span class="info-label">ç›´å¾„ï¼š</span>${info.diameter}</div>`;
            html += `<div class="info-item"><span class="info-label">è´¨é‡ï¼š</span>${info.mass}</div>`;
            html += `<div class="info-item"><span class="info-label">æ¸©åº¦ï¼š</span>${info.temperature}</div>`;
            
            if (info.orbitalPeriod) {
                html += `<div class="info-item"><span class="info-label">å…¬è½¬ï¼š</span>${info.orbitalPeriod}</div>`;
            }
            if (info.composition) {
                html += `<div class="info-item"><span class="info-label">ç»„æˆï¼š</span>${info.composition}</div>`;
            }
            
            html += `<div class="info-item" style="margin-top: 15px;">${info.description}</div>`;
            
            if (info.features && info.features.length > 0) {
                html += `<div class="info-item" style="margin-top: 15px;"><span class="info-label">ç‰¹ç‚¹ï¼š</span></div>`;
                html += '<ul style="margin-left: 20px; margin-top: 5px;">';
                info.features.forEach(feature => {
                    html += `<li>${feature}</li>`;
                });
                html += '</ul>';
            }
            
            content.innerHTML = html;
            card.classList.add('show');
        }

        // å…³é—­æ˜ŸçƒçŸ¥è¯†å¡ç‰‡
        function closePlanetCard() {
            const card = document.getElementById('planet-card');
            card.classList.remove('show');
        }

        // åˆ‡æ¢æš‚åœ/æ’­æ”¾
        function togglePause() {
            isPaused = !isPaused;
            const btn = document.getElementById('pause-btn');
            if (isPaused) {
                btn.textContent = 'â–¶ï¸ æ’­æ”¾';
            } else {
                btn.textContent = 'â¸ï¸ æš‚åœ';
            }
        }

        // çª—å£å¤§å°è°ƒæ•´
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        // åŠ¨ç”»å¾ªç¯
        function animate() {
            requestAnimationFrame(animate);

            // æ›´æ–°ç›¸æœºä½ç½®
            camera.position.x = cameraDistance * Math.sin(cameraAngle.phi) * Math.cos(cameraAngle.theta);
            camera.position.y = cameraDistance * Math.cos(cameraAngle.phi);
            camera.position.z = cameraDistance * Math.sin(cameraAngle.phi) * Math.sin(cameraAngle.theta);
            camera.lookAt(0, 0, 0);

            // åªæœ‰åœ¨æœªæš‚åœæ—¶æ‰æ›´æ–°æ˜Ÿçƒè¿åŠ¨
            if (!isPaused) {
                // å¤ªé˜³è‡ªè½¬
                sun.rotation.y += 0.001;

                // è¡Œæ˜Ÿå…¬è½¬å’Œè‡ªè½¬ï¼ˆæ¤­åœ†è½¨é“ï¼‰
                planets.forEach(planet => {
                    // æ›´æ–°è§’åº¦ï¼ˆå¼€æ™®å‹’ç¬¬äºŒå®šå¾‹ç®€åŒ–ï¼šè¿‘æ—¥ç‚¹é€Ÿåº¦å¿«ï¼Œè¿œæ—¥ç‚¹é€Ÿåº¦æ…¢ï¼‰
                    // ä½¿ç”¨çœŸå®çš„æ¤­åœ†è½¨é“å…¬å¼è®¡ç®—ä½ç½®
                    planet.angle += planet.revolutionSpeed;
                    
                    // æ¤­åœ†è½¨é“ä½ç½®è®¡ç®—ï¼Œå¤ªé˜³åœ¨ç„¦ç‚¹
                    const x = Math.cos(planet.angle) * planet.semiMajorAxis - planet.focalDistance;
                    const z = Math.sin(planet.angle) * planet.semiMinorAxis;
                    
                    planet.mesh.position.x = x;
                    planet.mesh.position.z = z;
                    
                    // è‡ªè½¬
                    planet.mesh.rotation.y += planet.rotationSpeed;
                });
                
                // å°è¡Œæ˜Ÿå¸¦å…¬è½¬
                asteroidBelt.children.forEach(asteroid => {
                    asteroid.userData.angle += asteroid.userData.speed;
                    asteroid.position.x = Math.cos(asteroid.userData.angle) * asteroid.userData.radius;
                    asteroid.position.z = Math.sin(asteroid.userData.angle) * asteroid.userData.radius;
                });
            }

            renderer.render(scene, camera);
        }

        animate();
    </script>
</body>
</html>
